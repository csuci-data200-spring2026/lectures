---
title: "Data 200: Week 2 Lecture"
subtitle: "Data basics and summaries"
author: "Medina - CSU Channel Islands"
format: 
  revealjs:
    theme: [sky, ../slide-style.scss]
    slide-number: true
execute:
  echo: true  
---

```{r}
#| echo: false
#| message: false
#| warning: false
library(fivethirtyeight)
library(openintro)
library(tidyverse)
library(DiagrammeR)
library(DiagrammeRsvg)
library(janitor)
library(bayesrules)

data(bad_drivers)

candy_rankings <- candy_rankings %>% 
  select(competitorname, chocolate, fruity, sugarpercent, pricepercent, winpercent)

data(hotel_bookings)
```

# R packages

## Phone apps vs. R packages

:::: {.columns}

::: {.column width="50%"}
When you buy a new phone it comes with some apps pre-installed.

- Calendar
- Email
- Messages
:::

::: {.column width="50%"}
If you want to use a different app you can install it.

- Instagram
- GMail
- BlueSky
:::

::::

When you download R for the first time to your computer. It comes with some packages already installed. You can also install many other R packages.

## R packages

What do R packages have? All sorts of things but mainly

- functions

- datasets

## R packages

Try running the following code:

```{r error = TRUE}
beep()
```

Why are we seeing this error?

## To install and load an R package

1. Install the package onto our computer **once**

    - Option 1: use `install.packages()` in the Console
    - Option 2: use "Install" button in "Packages" pane in RStudio

2. Load the package into **each** session/document

    - Option 1: Use the `library()` function to load entire package
    - Option 2: Use the `::` option to load a single function


## Installation option 1: `install.packages()`

In your **Console**, install the beepr package

```{r eval = FALSE}
install.packages("beepr")
```

We do this in the Console because we only need to do it once. Don't forget quotations!



## Installation option 2: Packages pane

```{r echo = FALSE, out.width="40%", fig.align='center'}
knitr::include_graphics("img/packages-pane.png")
```

Packages Pane > Install



## Sometimes RStudio will prompt you to install

```{r echo = FALSE, out.width="80%", fig.align='center'}
knitr::include_graphics("img/rstudio-install.png")
```

If you try to skip to step 2, loading a package, without first installing it RStudio may let you know.


## Loading option 1: `library()`


Option 1 (more common)
```{r warning = FALSE, eval = FALSE}
library(beepr)
beep()
```

- Line 1 loads the library so on any following line you can use a function or dataset from the package
- Line 2 uses the package

## Loading option 2: `::`

Option 2 (less common)

```{r eval = FALSE}
beepr::beep()
```

- structure is package name, ::, function()
- This may be useful if

    - the package is large but you only want to use a function once
    - there are conflicts, i.e., multiple packages containing functions with the same name

## Open Source

- Any one around the world can create R packages.



- Good part: We are able to do pretty much anything R because someone from around the world has developed the package and shared it.


- Bad part: The language can be inconsistent.


- Good news: We have tidyverse.



## Tidyverse


>The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures.

[tidyverse.org](https://tidyverse.org/)


## Tidyverse

In short, tidyverse is a family of packages we will commonly use. 

```{r}
#| eval: false
#| echo: true
library(tidyverse)
```

- Loading tidyverse loads a bunch of packages at once (e.g., ggplot2, dplyr, readr, stringr, lubridate, ...)
- It is good practice to load all packages in an RChunk at the top of your Quarto document (after yaml)

# Data basics

## Familiarizing yourself with the data

```{r}
library(PASWR)
data("titanic3")
```

The data() function loads in our `titanic3` data from the PASWR package.

## Data Frame

```{r echo=FALSE, out.width='100%'}
knitr::include_graphics('img/titanic-head.png')
knitr::include_graphics('img/titanic-tail.png')
```

- `pclass` a factor with levels 1st, 2nd, and 3rd
- `survived` Survival (0 = No; 1 = Yes)
- `age` age in years
- `sibsp` Number of Siblings/Spouses Aboard
- ...

## Data documentation

```{r}
#| eval: false
?titanic3
```

```{r}
#| echo: false
#| fig-align: center
knitr::include_graphics('img/titanic-help.png')
```



## Data Frame

The columns of a data frame are called **variables** 

The rows of a data frame are called **cases** or **observations**

For the titanic 

- the variables are: `pclass`, `survived`, `name`, `sex`, `age`, `sibsp`, `parch`, `ticket`, `fare`, `cabin`, `embarked`, `boat`, `body`, `home.dest`
- the cases/observations are passengers

## 

```{r}
ncol(titanic3)

nrow(titanic3)
```

- The data frame has `r ncol(titanic3)` __variables__ 

- The data frame has `r nrow(titanic3)` __cases__ or __observations__.

## View top of data frame

```{r}
head(titanic3)
```

## View bottom of data frame

```{r}
tail(titanic3)
```

## View structure of data frame

```{r}
glimpse(titanic3)
```

## Variable types in statistics

```{r echo = FALSE, fig.align='center'}
#| echo: false
#| fig-align: center
#| out-width: 80%
diagram <- grViz("
    digraph {
        # graph aesthetics
        graph [ranksep = 0.3]

        # node definitions with substituted label text
        1 [label = 'Variables']
        2 [label = 'Categorical']
        3 [label = 'Numerical']
        4 [label = 'Nominal']
        5 [label = 'Ordinal']
        6 [label = 'Discrete']
        7 [label = 'Continuous']

        
        # edge definitions with the node IDs
        1 -> 2
        1 -> 3
        2 -> 4
        2 -> 5
        3 -> 6
        3 -> 7
    }
")

tmp <- capture.output(rsvg::rsvg_png(
  charToRaw(export_svg(diagram)),
  'img/diagram.png')
)

knitr::include_graphics("img/diagram.png") 

```

Identifying the type of variable will help us to know which plots, summary statistics, and models are appropriate!

## Numerical variables

**Numerical variables** have numeric meaning, so math operations like taking a mean make sense. Numerical variables are either:

- **Discrete numerical** have a finite or countable number of possibilities (e.g., Number of siblings: 0, 1, 2, ...)
- **Continuous numerical** have an infinite number of possibilities (e.g., Distance: 1, 1.3, 1.25 miles,...)

Note not all numbers are numerical variables (i.e., zip codes are numbers but we can't add, divide, etc and get something meaningful.)

## Categorical variables

**Categorical variables** do not have numeric meaning, we can't do mathematical operations 

- **Ordinal categorical** have categories with a natural ordering (e.g., Passenger class: 1st, 2nd, or 3rd)
- **Nominal categorical** have categories without a natural ordering (e.g., Port embarked: Cherbourg, Queenstown, or Southampton)


## Storage types of variables in R

Categorical types:

- `logical`: TRUE (1), FALSE (0)  
- `character`: takes string values (e.g. a person's name, address)  
- `factor`: categorical variables with different levels
. . .

Numerical types:

- `integer`: integer (for discrete)  
- `double`: floating decimal (for continuous)
- `numeric`: integer or double  

## 

As a data scientist it is your job to check the type(s) of data that you are working with. Do not  assume you will work with clean data frames, with clean names, labels, and types.

# Describing data with numbers

## Summarizing categorical variables

- Counts

```{r}
count(titanic3, survived)
```

- Proportions

```{r}
janitor::tabyl(titanic3, pclass)
```

## Summarizing numerical variables

Some common measures of centrality:

- Mean `mean()` 
- Median `median()`

Some common measures of spread:

- Standard Deviation `sd()` 
- Variance `var()`
- Quantiles `quantile()`

The `summarize()` function can help us compute multiple summary stats together!